typescript\nimport { IsString, IsNotEmpty, MinLength, IsIn, IsPhoneNumber } from 'class-validator';\nimport { Transform, TransformFnParams } from 'class-transformer';\nimport * as sanitizeHtml from 'sanitize-html';\n\n// دالة التطهير (Sanitization) لمنع حقن XSS\nconst sanitizeInput = (params: TransformFnParams) => {\n  if (typeof params.value!== 'string') return params.value;\n  return sanitizeHtml(params.value, { allowedTags:, allowedAttributes: {}, }).trim();\n};\n\nexport class CreateSubmissionDto {\n  @IsNotEmpty({ message: 'الاسم مطلوب' })\n  @IsString()\n  @MinLength(3)\n  @Transform(sanitizeInput)\n  name: string;\n\n  @IsNotEmpty({ message: 'رقم الهاتف مطلوب' })\n  @IsString()\n  @IsPhoneNumber('EG', { message: 'صيغة رقم الهاتف المصري غير صحيحة' })\n  phone: string;\n\n  @IsNotEmpty({ message: 'المنطقة والعنوان مطلوبان' })\n  @IsString()\n  @Transform(sanitizeInput)\n  area: string;\n\n  @IsNotEmpty({ message: 'مستوى المساهمة مطلوب' })\n  @IsString()\n  @IsIn(['High', 'Medium', 'Low', 'Neutral'])\n  contributionLevel: string;\n}\n
